(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

exports.promise = {
  name: 'promise',
  of: function of(val) {
    return function (resolve) {
      return resolve(val);
    };
  },
  map: function map(funk, val) {
    return function (resolve) {
      val(function (value) {
        return resolve(funk(value));
      });
    };
  },

  flat: function flat(val, innerMonad) {
    return function (resolve) {
      val(function (i) {
        innerMonad.map(function (innerPromise) {
          innerPromise(function (value) {
            resolve(innerMonad.map(function () {
              return value;
            }, i));
          });
        }, i);
      });
    };
  }
};

},{}],2:[function(require,module,exports){
'use strict';

exports.prim = require('./prim');
exports.data = require('./data');
exports.comp = require('./comp');

var id = {
  flatMap: function flatMap(funk, val) {
    return funk(val);
  }

};

exports.make = function make_monad(m1, m2) {
  m1.inner = m2; // maybe
  m2.inner = id;
  var proto = {
    map: function map(funk) {
      return create(m2.map(function (val) {
        return m1.map(funk, val);
      }, this._value));
    },
    flatMap: function flatMap(funk) {
      var funkk = function funkk(val) {
        return funk(val)._value;
      };
      return create(m1.flatMap(funkk, this._value, m2));
    }
  };
  function create(value) {
    var obj = Object.create(proto);
    obj._value = value;
    return obj;
  }

  function make(value) {
    return create(m2.of(m1.of(value)));
  }
  make.prototype = proto;
  return make;
};

exports.print = function print(val) {
  console.log(val);return val;
};

},{"./comp":1,"./data":3,"./prim":4}],3:[function(require,module,exports){
'use strict';

exports.id = {
  name: 'id',
  of: function of(val) {
    return { idVal: val };
  },
  map: function map(funk, val) {
    return {
      idVal: funk(val.idVal)
    };
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return innerMonad.flatMap(function (innerId) {
      return funk(innerId.idVal);
    }, val, innerMonad.inner);
  }
};

exports.maybe = {
  name: 'maybe',
  of: function of(val) {
    return { maybeVal: val };
  },
  map: function map(funk, val) {
    return {
      maybeVal: val.maybeVal === undefined ? val.maybeVal : funk(val.maybeVal)
    };
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return innerMonad.flatMap(function (innerMaybe) {
      return innerMaybe.maybeVal === undefined ? innerMaybe.maybeVal : funk(innerMaybe.maybeVal);
    }, val, innerMonad.inner);
  }
};

},{}],4:[function(require,module,exports){
'use strict';

exports.list = {
  name: 'list',
  of: function of(val) {
    return val.constructor === Array ? val : [val];
  },
  map: function map(funk, val) {
    return val.map(funk);
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return val.reduce(function (list, val) {
      return innerMonad.funk(val);
    }, []);
  },

  flat: function flat(val, innerMonad) {
    return val.reduce(function (list, i) {
      var index = -1;
      var over = false;
      while (!over) {
        list.push(innerMonad.map(function (innerList) {
          index++;
          if (index - 1 === innerList.length) {
            over = true;
          }
          return innerList[index];
        }, i));
      }
      return list;
    }, []);
  }

};

},{}]},{},[1,2,3,4])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYm9yaXNtYXJpbm92L3Nvbm5lL2xpYi9jb21wLmpzIiwiL1VzZXJzL2JvcmlzbWFyaW5vdi9zb25uZS9saWIvY29yZS5qcyIsIi9Vc2Vycy9ib3Jpc21hcmlub3Yvc29ubmUvbGliL2RhdGEuanMiLCIvVXNlcnMvYm9yaXNtYXJpbm92L3Nvbm5lL2xpYi9wcmltLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxPQUFPLENBQUMsT0FBTyxHQUFHO0FBQ2hCLE1BQUksRUFBRSxTQUFTO0FBQ2YsSUFBRSxFQUFFLFlBQVUsR0FBRyxFQUFFO0FBQUMsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUFFLGFBQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQUMsQ0FBQTtHQUFFO0FBQ3RFLEtBQUcsRUFBRSxhQUFVLElBQUksRUFBRSxHQUFHLEVBQUU7QUFDeEIsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUN4QixTQUFHLENBQUMsVUFBVSxLQUFLLEVBQUU7QUFDbkIsZUFBTyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7T0FDNUIsQ0FBQyxDQUFBO0tBQ0gsQ0FBQTtHQUNGOztBQUVELE1BQUksRUFBRSxjQUFVLEdBQUcsRUFBRSxVQUFVLEVBQUU7QUFDL0IsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUN4QixTQUFHLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFDZixrQkFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFVLFlBQVksRUFBRTtBQUNyQyxzQkFBWSxDQUFDLFVBQVUsS0FBSyxFQUFFO0FBQzVCLG1CQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxZQUFZO0FBQUMscUJBQU8sS0FBSyxDQUFBO2FBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxD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Q0FBQyxVQUFVLElBQUksRUFBRSxHQUFHLEVBQUU7QUFDckMsYUFBTyxVQUFVLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQzVCLEVBQUUsRUFBRSxDQUFDLENBQUE7R0FDUDs7QUFFRCxNQUFJLEVBQUUsY0FBVSxHQUFHLEVBQUUsVUFBVSxFQUFFO0FBQy9CLFdBQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLElBQUksRUFBRSxDQUFDLEVBQUU7QUFDbkMsVUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFDZCxVQUFJLElBQUksR0FBRyxLQUFLLENBQUE7QUFDaEIsYUFBTyxDQUFDLElBQUksRUFBRTtBQUNaLFlBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFVLFNBQVMsRUFBRTtBQUM1QyxlQUFLLEVBQUUsQ0FBQTtBQUNQLGNBQUksS0FBSyxHQUFHLENBQUMsS0FBSyxTQUFTLENBQUMsTUFBTSxFQUFFO0FBQUMsZ0JBQUksR0FBRyxJQUFJLENBQUE7V0FBQztBQUNqRCxpQkFBTyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUE7U0FDeEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO09BQ1A7QUFDRCxhQUFPLElBQUksQ0FBQTtLQUNaLEVBQUUsRUFBRSxDQUFDLENBQUE7R0FDUDs7Q0FFRixDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImV4cG9ydHMucHJvbWlzZSA9IHtcbiAgbmFtZTogJ3Byb21pc2UnLFxuICBvZjogZnVuY3Rpb24gKHZhbCkge3JldHVybiBmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXR1cm4gcmVzb2x2ZSh2YWwpfSB9LFxuICBtYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgIHZhbChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoZnVuayh2YWx1ZSkpXG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICBmbGF0OiBmdW5jdGlvbiAodmFsLCBpbm5lck1vbmFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICB2YWwoZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgaW5uZXJNb25hZC5tYXAoZnVuY3Rpb24gKGlubmVyUHJvbWlzZSkge1xuICAgICAgICAgIGlubmVyUHJvbWlzZShmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaW5uZXJNb25hZC5tYXAoZnVuY3Rpb24gKCkge3JldHVybiB2YWx1ZX0sIGkpKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sIGkpXG5cbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG4iLCJleHBvcnRzLnByaW0gPSByZXF1aXJlKCcuL3ByaW0nKVxuZXhwb3J0cy5kYXRhID0gcmVxdWlyZSgnLi9kYXRhJylcbmV4cG9ydHMuY29tcCA9IHJlcXVpcmUoJy4vY29tcCcpXG5cbnZhciBpZCA9IHtcbiAgZmxhdE1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiBmdW5rKHZhbClcbiAgfVxuXG59XG5cbmV4cG9ydHMubWFrZSA9IGZ1bmN0aW9uIG1ha2VfbW9uYWQgKG0xLCBtMikge1xuICBtMS5pbm5lciA9IG0yIC8vIG1heWJlXG4gIG0yLmlubmVyID0gaWRcbiAgdmFyIHByb3RvID0ge1xuICAgIG1hcDogZnVuY3Rpb24gKGZ1bmspIHtcbiAgICAgIHJldHVybiBjcmVhdGUobTIubWFwKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgcmV0dXJuIG0xLm1hcChmdW5rLCB2YWwpXG4gICAgICB9LCB0aGlzLl92YWx1ZSkpXG4gICAgfSxcbiAgICBmbGF0TWFwOiBmdW5jdGlvbiAoZnVuaykge1xuICAgICAgdmFyIGZ1bmtrID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gZnVuayh2YWwpLl92YWx1ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNyZWF0ZShtMS5mbGF0TWFwKGZ1bmtrLCB0aGlzLl92YWx1ZSwgbTIpKVxuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBjcmVhdGUgKHZhbHVlKSB7XG4gICAgdmFyIG9iaiA9IE9iamVjdC5jcmVhdGUocHJvdG8pXG4gICAgb2JqLl92YWx1ZSA9IHZhbHVlXG4gICAgcmV0dXJuIG9ialxuICB9XG5cbiAgZnVuY3Rpb24gbWFrZSAodmFsdWUpIHtcbiAgICByZXR1cm4gY3JlYXRlKG0yLm9mKG0xLm9mKHZhbHVlKSkpXG4gIH1cbiAgbWFrZS5wcm90b3R5cGUgPSBwcm90b1xuICByZXR1cm4gbWFrZVxufVxuXG5leHBvcnRzLnByaW50ID0gZnVuY3Rpb24gcHJpbnQgKHZhbCkge2NvbnNvbGUubG9nKHZhbCk7cmV0dXJuIHZhbH1cbiIsImV4cG9ydHMuaWQgPSB7XG4gIG5hbWU6ICdpZCcsXG4gIG9mOiBmdW5jdGlvbiAodmFsKSB7IHJldHVybiB7aWRWYWw6IHZhbCB9IH0sXG4gIG1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiB7XG4gICAgICBpZFZhbDogZnVuayh2YWwuaWRWYWwpXG4gICAgfVxuICB9LFxuICBmbGF0TWFwOiBmdW5jdGlvbiAoZnVuaywgdmFsLCBpbm5lck1vbmFkKSB7XG4gICAgcmV0dXJuIGlubmVyTW9uYWQuZmxhdE1hcChmdW5jdGlvbiAoaW5uZXJJZCkge1xuICAgICAgcmV0dXJuIGZ1bmsoaW5uZXJJZC5pZFZhbClcbiAgICB9LCB2YWwsIGlubmVyTW9uYWQuaW5uZXIpXG4gIH1cbn1cblxuZXhwb3J0cy5tYXliZSA9IHtcbiAgbmFtZTogJ21heWJlJyxcbiAgb2Y6IGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHttYXliZVZhbDogdmFsIH0gfSxcbiAgbWFwOiBmdW5jdGlvbiAoZnVuaywgdmFsKSB7XG4gICAgcmV0dXJuIHtcbiAgICBtYXliZVZhbDogdmFsLm1heWJlVmFsID09PSB1bmRlZmluZWQgPyB2YWwubWF5YmVWYWwgOiBmdW5rKHZhbC5tYXliZVZhbClcbiAgICB9XG4gIH0sXG4gIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwsIGlubmVyTW9uYWQpIHtcbiAgICByZXR1cm4gaW5uZXJNb25hZC5mbGF0TWFwKGZ1bmN0aW9uIChpbm5lck1heWJlKSB7XG4gICAgICByZXR1cm4gaW5uZXJNYXliZS5tYXliZVZhbCA9PT0gdW5kZWZpbmVkID8gaW5uZXJNYXliZS5tYXliZVZhbCA6IGZ1bmsoaW5uZXJNYXliZS5tYXliZVZhbClcbiAgICB9LCB2YWwsIGlubmVyTW9uYWQuaW5uZXIpXG4gIH1cbn1cbiIsImV4cG9ydHMubGlzdCA9IHtcbiAgbmFtZTogJ2xpc3QnLFxuICBvZjogZnVuY3Rpb24gKHZhbCkgeyByZXR1cm4gdmFsLmNvbnN0cnVjdG9yID09PSBBcnJheSA/IHZhbCA6IFt2YWxdIH0sXG4gIG1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiB2YWwubWFwKGZ1bmspXG4gIH0sXG4gIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwsIGlubmVyTW9uYWQpIHtcbiAgICByZXR1cm4gdmFsLnJlZHVjZShmdW5jdGlvbiAobGlzdCwgdmFsKSB7XG4gICAgICByZXR1cm4gaW5uZXJNb25hZC5mdW5rKHZhbClcbiAgICB9LCBbXSlcbiAgfSxcblxuICBmbGF0OiBmdW5jdGlvbiAodmFsLCBpbm5lck1vbmFkKSB7XG4gICAgcmV0dXJuIHZhbC5yZWR1Y2UoZnVuY3Rpb24gKGxpc3QsIGkpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xXG4gICAgICB2YXIgb3ZlciA9IGZhbHNlXG4gICAgICB3aGlsZSAoIW92ZXIpIHtcbiAgICAgICAgbGlzdC5wdXNoKGlubmVyTW9uYWQubWFwKGZ1bmN0aW9uIChpbm5lckxpc3QpIHtcbiAgICAgICAgICBpbmRleCsrXG4gICAgICAgICAgaWYgKGluZGV4IC0gMSA9PT0gaW5uZXJMaXN0Lmxlbmd0aCkge292ZXIgPSB0cnVlfVxuICAgICAgICAgIHJldHVybiBpbm5lckxpc3RbaW5kZXhdXG4gICAgICAgIH0sIGkpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGxpc3RcbiAgICB9LCBbXSlcbiAgfVxuXG59XG4iXX0=
