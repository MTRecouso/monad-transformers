(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

exports.promise = {
  name: 'promise',
  of: function of(val) {
    return function (resolve) {
      return resolve(val);
    };
  },
  map: function map(funk, val) {
    return function (resolve) {
      val(function (value) {
        return resolve(funk(value));
      });
    };
  },

  flat: function flat(val, innerMonad) {
    return function (resolve) {
      val(function (i) {
        innerMonad.map(function (innerPromise) {
          innerPromise(function (value) {
            resolve(innerMonad.map(function () {
              return value;
            }, i));
          });
        }, i);
      });
    };
  }
};

},{}],2:[function(require,module,exports){
'use strict';

exports.id = {
  name: 'id',
  of: function of(val) {
    return { idVal: val };
  },
  map: function map(funk, val) {
    return {
      idVal: funk(val.idVal)
    };
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return innerMonad.flatMap(function (innerId) {
      return funk(innerId.idVal);
    }, val, innerMonad.inner);
  }
};

exports.maybe = {
  name: 'maybe',
  of: function of(val) {
    return { maybeVal: val };
  },
  map: function map(funk, val) {
    return {
      maybeVal: val.maybeVal === undefined ? val.maybeVal : funk(val.maybeVal)
    };
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return innerMonad.flatMap(function (innerMaybe) {
      return innerMaybe.maybeVal === undefined ? innerMaybe.maybeVal : funk(innerMaybe.maybeVal);
    }, val, innerMonad.inner);
  }
};

},{}],3:[function(require,module,exports){
'use strict';

exports.prim = require('./prim');
exports.data = require('./data');
exports.comp = require('./comp');

// The ID monad is at the bottom of each monad stack
var id = {
  of: function of(val) {
    return val;
  },
  map: function map(funk, val) {
    return funk(val);
  },
  flatMap: function flatMap(funk, val) {
    return funk(val);
  }
};

exports.make = function make_monad(m1, m2) {
  m1.inner = m2;
  m2.inner = id;
  var proto = {
    map: function map(funk) {
      return create(m2.map(function (val) {
        return m1.map(funk, val);
      }, this._value));
    },
    flatMap: function flatMap(funk) {
      var funkk = function funkk(val) {
        return funk(val)._value;
      };
      return create(m1.flatMap(funkk, this._value, m2));
    }
  };

  function create(value) {
    var obj = Object.create(proto);
    obj._value = value;
    return obj;
  }

  function make(value) {
    return create(m2.of(m1.of(value)));
  }

  make.prototype = proto;
  return make;
};

exports.print = function print(val) {
  console.log(val);return val;
};

},{"./comp":1,"./data":2,"./prim":4}],4:[function(require,module,exports){
'use strict';

exports.list = {
  name: 'list',
  of: function of(val) {
    return val.constructor === Array ? val : [val];
  },
  map: function map(funk, val) {
    return val.map(funk);
  },
  flatMap: function flatMap(funk, val, innerMonad) {
    return val.reduce(function (list, val) {
      return innerMonad.funk(val);
    }, []);
  },

  flat: function flat(val, innerMonad) {
    return val.reduce(function (list, i) {
      var index = -1;
      var over = false;
      while (!over) {
        list.push(innerMonad.map(function (innerList) {
          index++;
          if (index - 1 === innerList.length) {
            over = true;
          }
          return innerList[index];
        }, i));
      }
      return list;
    }, []);
  }

};

},{}]},{},[1,2,3,4])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYm9yaXNtYXJpbm92L3Nvbm5lL2xpYi9jb21wLmpzIiwiL1VzZXJzL2JvcmlzbWFyaW5vdi9zb25uZS9saWIvZGF0YS5qcyIsIi9Vc2Vycy9ib3Jpc21hcmlub3Yvc29ubmUvbGliL21haW4uanMiLCIvVXNlcnMvYm9yaXNtYXJpbm92L3Nvbm5lL2xpYi9wcmltLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxPQUFPLENBQUMsT0FBTyxHQUFHO0FBQ2hCLE1BQUksRUFBRSxTQUFTO0FBQ2YsSUFBRSxFQUFFLFlBQVUsR0FBRyxFQUFFO0FBQUMsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUFFLGFBQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQUMsQ0FBQTtHQUFFO0FBQ3RFLEtBQUcsRUFBRSxhQUFVLElBQUksRUFBRSxHQUFHLEVBQUU7QUFDeEIsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUN4QixTQUFHLENBQUMsVUFBVSxLQUFLLEVBQUU7QUFDbkIsZUFBTyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7T0FDNUIsQ0FBQyxDQUFBO0tBQ0gsQ0FBQTtHQUNGOztBQUVELE1BQUksRUFBRSxjQUFVLEdBQUcsRUFBRSxVQUFVLEVBQUU7QUFDL0IsV0FBTyxVQUFVLE9BQU8sRUFBRTtBQUN4QixTQUFHLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFDZixrQkFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFVLFlBQVksRUFBRTtBQUNyQyxzQkFBWSxDQUFDLFVBQVUsS0FBSyxFQUFFO0FBQzVCLG1CQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxZQUFZO0FBQUMscUJBQU8sS0FBSyxDQUFBO2FBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO1dBQ3ZELENBQUMsQ0FBQTtTQUNILEVBQUUsQ0FBQyxDQUFDLENBQUE7T0FFTixDQUFDLENBQUE7S0FDSCxDQUFBO0dBQ0Y7Q0FDRixDQUFBOzs7OztBQ3ZCRCxPQUFPLENBQUMsRUFBRSxHQUFHO0FBQ1gsTUFBSSxFQUFFLElBQUk7QUFDVixJQUFFLEVBQUUsWUFBVSxHQUFHLEVBQUU7QUFBRSxXQUFPLEVBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFBO0dBQUU7QUFDM0MsS0FBRyxFQUFFLGFBQVUsSUFBSSxFQUFFLEdBQUcsRUFBRTtBQUN4QixXQUFPO0FBQ0wsV0FBSyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO0tBQ3ZCLENBQUE7R0FDRjtBQUNELFNBQU8sRUFBRSxpQkFBVSxJQUFJLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRTtBQUN4QyxXQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBVSxPQUFPLEVBQUU7QUFDM0MsYUFBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFBO0tBQzNCLEVBQUUsR0FBRyxFQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtHQUMxQjtDQUNGLENBQUE7O0FBRUQsT0FBTyxDQUFDLEtBQUssR0FBRztBQUNkLE1BQUksRUFBRSxPQUFPO0FBQ2IsSUFBRSxFQUFFLFlBQVUsR0FBRyxFQUFFO0FBQUUsV0FBTyxFQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQTtHQUFFO0FBQzlDLEtBQUcsRUFBRSxhQUFVLElBQUksRUFBRSxHQUFHLEVBQUU7QUFDeEIsV0FBTztBQUNQLGNBQVEsRUFBRSxHQUFHLENBQUMsUUFBUSxLQUFLLFNBQVMsR0FBRyxHQUFHLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDO0tBQ3ZFLENBQUE7R0FDRjtBQUNELFNBQU8sRUFBRSxpQkFBVSxJQUFJLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRTtBQUN4QyxXQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBVSxVQUFVLEVBQUU7QUFDOUMsYUFBTyxVQUFVLENBQUMsUUFBUSxLQUFLLFNBQVMsR0FBRyxVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUE7S0FDM0YsRUFBRSxHQUFHLEVBQUUsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFBO0dBQzFCO0NBQ0YsQ0FBQTs7Ozs7QUM1QkQsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7QUFDaEMsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7QUFDaEMsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7OztBQUdoQyxJQUFNLEVBQUUsR0FBRztBQUNULElBQUUsRUFBRSxZQUFVLEdBQUcsRUFBRTtBQUNqQixXQUFPLEdBQUcsQ0FBQTtHQUNYO0FBQ0QsS0FBRyxFQUFFLGFBQVUsSUFBSSxFQUFFLEdBQUcsRUFBRTtBQUN4QixXQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtHQUNqQjtBQUNELFNBQU8sRUFBRSxpQkFBVSxJQUFJLEVBQUUsR0FBRyxFQUFFO0FBQzVCLFdBQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0dBQ2pCO0NBQ0YsQ0FBQTs7QUFFRCxPQUFPLENBQUMsSUFBSSxHQUFHLFNBQVMsVUFBVSxDQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUU7QUFDMUMsSUFBRSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUE7QUFDYixJQUFFLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQTtBQUNiLE1BQUksS0FBSyxHQUFHO0FBQ1YsT0FBRyxFQUFFLGFBQVUsSUFBSSxFQUFFO0FBQ25CLGFBQU8sTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBVSxHQUFHLEVBQUU7QUFDbEMsZUFBTyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQTtPQUN6QixFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBO0tBQ2pCO0FBQ0QsV0FBTyxFQUFFLGlCQUFVLElBQUksRUFBRTtBQUN2QixVQUFJLEtBQUssR0FBRyxTQUFSLEtBQUssQ0FBYSxHQUFHLEVBQUU7QUFDekIsZUFBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFBO09BQ3hCLENBQUE7QUFDRCxhQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUE7S0FDbEQ7R0FDRixDQUFBOztBQUVELFdBQVMsTUFBTSxDQUFFLEtBQUssRUFBRTtBQUN0QixRQUFJLEdBQUcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzlCLE9BQUcsQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFBO0FBQ2xCLFdBQU8sR0FBRyxDQUFBO0dBQ1g7O0FBRUQsV0FBUyxJQUFJLENBQUUsS0FBSyxFQUFFO0FBQ3BCLFdBQU8sTUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUE7R0FDbkM7O0FBRUQsTUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUE7QUFDdEIsU0FBTyxJQUFJLENBQUE7Q0FDWixDQUFBOztBQUVELE9BQU8sQ0FBQyxLQUFLLEdBQUcsU0FBUyxLQUFLLENBQUUsR0FBRyxFQUFFO0FBQUMsU0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEdBQUcsQ0FBQTtDQUFDLENBQUE7Ozs7O0FDaERsRSxPQUFPLENBQUMsSUFBSSxHQUFHO0FBQ2IsTUFBSSxFQUFFLE1BQU07QUFDWixJQUFFLEVBQUUsWUFBVSxHQUFHLEVBQUU7QUFBRSxXQUFPLEdBQUcsQ0FBQyxXQUFXLEtBQUssS0FBSyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0dBQUU7QUFDckUsS0FBRyxFQUFFLGFBQVUsSUFBSSxFQUFFLEdBQUcsRUFBRTtBQUN4QixXQUFPLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7R0FDckI7QUFDRCxTQUFPLEVBQUUsaUJBQVUsSUFBSSxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUU7QUFDeEMsV0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVUsSUFBSSxFQUFFLEdBQUcsRUFBRTtBQUNyQyxhQUFPLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7S0FDNUIsRUFBRSxFQUFFLENBQUMsQ0FBQTtHQUNQOztBQUVELE1BQUksRUFBRSxjQUFVLEdBQUcsRUFBRSxVQUFVLEVBQUU7QUFDL0IsV0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVUsSUFBSSxFQUFFLENBQUMsRUFBRTtBQUNuQyxVQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQTtBQUNkLFVBQUksSUFBSSxHQUFHLEtBQUssQ0FBQTtBQUNoQixhQUFPLENBQUMsSUFBSSxFQUFFO0FBQ1osWUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFVBQVUsU0FBUyxFQUFFO0FBQzVDLGVBQUssRUFBRSxDQUFBO0FBQ1AsY0FBSSxLQUFLLEdBQUcsQ0FBQyxLQUFLLFNBQVMsQ0FBQyxNQUFNLEVBQUU7QUFBQyxnQkFBSSxHQUFHLElBQUksQ0FBQTtXQUFDO0FBQ2pELGlCQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtTQUN4QixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7T0FDUDtBQUNELGFBQU8sSUFBSSxDQUFBO0tBQ1osRUFBRSxFQUFFLENBQUMsQ0FBQTtHQUNQOztDQUVGLENBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiZXhwb3J0cy5wcm9taXNlID0ge1xuICBuYW1lOiAncHJvbWlzZScsXG4gIG9mOiBmdW5jdGlvbiAodmFsKSB7cmV0dXJuIGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJldHVybiByZXNvbHZlKHZhbCl9IH0sXG4gIG1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgdmFsKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gcmVzb2x2ZShmdW5rKHZhbHVlKSlcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG4gIGZsYXQ6IGZ1bmN0aW9uICh2YWwsIGlubmVyTW9uYWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgIHZhbChmdW5jdGlvbiAoaSkge1xuICAgICAgICBpbm5lck1vbmFkLm1hcChmdW5jdGlvbiAoaW5uZXJQcm9taXNlKSB7XG4gICAgICAgICAgaW5uZXJQcm9taXNlKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmVzb2x2ZShpbm5lck1vbmFkLm1hcChmdW5jdGlvbiAoKSB7cmV0dXJuIHZhbHVlfSwgaSkpXG4gICAgICAgICAgfSlcbiAgICAgICAgfSwgaSlcblxuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydHMuaWQgPSB7XG4gIG5hbWU6ICdpZCcsXG4gIG9mOiBmdW5jdGlvbiAodmFsKSB7IHJldHVybiB7aWRWYWw6IHZhbCB9IH0sXG4gIG1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiB7XG4gICAgICBpZFZhbDogZnVuayh2YWwuaWRWYWwpXG4gICAgfVxuICB9LFxuICBmbGF0TWFwOiBmdW5jdGlvbiAoZnVuaywgdmFsLCBpbm5lck1vbmFkKSB7XG4gICAgcmV0dXJuIGlubmVyTW9uYWQuZmxhdE1hcChmdW5jdGlvbiAoaW5uZXJJZCkge1xuICAgICAgcmV0dXJuIGZ1bmsoaW5uZXJJZC5pZFZhbClcbiAgICB9LCB2YWwsIGlubmVyTW9uYWQuaW5uZXIpXG4gIH1cbn1cblxuZXhwb3J0cy5tYXliZSA9IHtcbiAgbmFtZTogJ21heWJlJyxcbiAgb2Y6IGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHttYXliZVZhbDogdmFsIH0gfSxcbiAgbWFwOiBmdW5jdGlvbiAoZnVuaywgdmFsKSB7XG4gICAgcmV0dXJuIHtcbiAgICBtYXliZVZhbDogdmFsLm1heWJlVmFsID09PSB1bmRlZmluZWQgPyB2YWwubWF5YmVWYWwgOiBmdW5rKHZhbC5tYXliZVZhbClcbiAgICB9XG4gIH0sXG4gIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwsIGlubmVyTW9uYWQpIHtcbiAgICByZXR1cm4gaW5uZXJNb25hZC5mbGF0TWFwKGZ1bmN0aW9uIChpbm5lck1heWJlKSB7XG4gICAgICByZXR1cm4gaW5uZXJNYXliZS5tYXliZVZhbCA9PT0gdW5kZWZpbmVkID8gaW5uZXJNYXliZS5tYXliZVZhbCA6IGZ1bmsoaW5uZXJNYXliZS5tYXliZVZhbClcbiAgICB9LCB2YWwsIGlubmVyTW9uYWQuaW5uZXIpXG4gIH1cbn1cbiIsImV4cG9ydHMucHJpbSA9IHJlcXVpcmUoJy4vcHJpbScpXG5leHBvcnRzLmRhdGEgPSByZXF1aXJlKCcuL2RhdGEnKVxuZXhwb3J0cy5jb21wID0gcmVxdWlyZSgnLi9jb21wJylcblxuLy8gVGhlIElEIG1vbmFkIGlzIGF0IHRoZSBib3R0b20gb2YgZWFjaCBtb25hZCBzdGFja1xuY29uc3QgaWQgPSB7XG4gIG9mOiBmdW5jdGlvbiAodmFsKSB7XG4gICAgcmV0dXJuIHZhbFxuICB9LFxuICBtYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwpIHtcbiAgICByZXR1cm4gZnVuayh2YWwpXG4gIH0sXG4gIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwpIHtcbiAgICByZXR1cm4gZnVuayh2YWwpXG4gIH1cbn1cblxuZXhwb3J0cy5tYWtlID0gZnVuY3Rpb24gbWFrZV9tb25hZCAobTEsIG0yKSB7XG4gIG0xLmlubmVyID0gbTJcbiAgbTIuaW5uZXIgPSBpZFxuICB2YXIgcHJvdG8gPSB7XG4gICAgbWFwOiBmdW5jdGlvbiAoZnVuaykge1xuICAgICAgcmV0dXJuIGNyZWF0ZShtMi5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gbTEubWFwKGZ1bmssIHZhbClcbiAgICAgIH0sIHRoaXMuX3ZhbHVlKSlcbiAgICB9LFxuICAgIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rKSB7XG4gICAgICB2YXIgZnVua2sgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHJldHVybiBmdW5rKHZhbCkuX3ZhbHVlXG4gICAgICB9XG4gICAgICByZXR1cm4gY3JlYXRlKG0xLmZsYXRNYXAoZnVua2ssIHRoaXMuX3ZhbHVlLCBtMikpXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlICh2YWx1ZSkge1xuICAgIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKHByb3RvKVxuICAgIG9iai5fdmFsdWUgPSB2YWx1ZVxuICAgIHJldHVybiBvYmpcbiAgfVxuXG4gIGZ1bmN0aW9uIG1ha2UgKHZhbHVlKSB7XG4gICAgcmV0dXJuIGNyZWF0ZShtMi5vZihtMS5vZih2YWx1ZSkpKVxuICB9XG5cbiAgbWFrZS5wcm90b3R5cGUgPSBwcm90b1xuICByZXR1cm4gbWFrZVxufVxuXG5leHBvcnRzLnByaW50ID0gZnVuY3Rpb24gcHJpbnQgKHZhbCkge2NvbnNvbGUubG9nKHZhbCk7cmV0dXJuIHZhbH1cbiIsImV4cG9ydHMubGlzdCA9IHtcbiAgbmFtZTogJ2xpc3QnLFxuICBvZjogZnVuY3Rpb24gKHZhbCkgeyByZXR1cm4gdmFsLmNvbnN0cnVjdG9yID09PSBBcnJheSA/IHZhbCA6IFt2YWxdIH0sXG4gIG1hcDogZnVuY3Rpb24gKGZ1bmssIHZhbCkge1xuICAgIHJldHVybiB2YWwubWFwKGZ1bmspXG4gIH0sXG4gIGZsYXRNYXA6IGZ1bmN0aW9uIChmdW5rLCB2YWwsIGlubmVyTW9uYWQpIHtcbiAgICByZXR1cm4gdmFsLnJlZHVjZShmdW5jdGlvbiAobGlzdCwgdmFsKSB7XG4gICAgICByZXR1cm4gaW5uZXJNb25hZC5mdW5rKHZhbClcbiAgICB9LCBbXSlcbiAgfSxcblxuICBmbGF0OiBmdW5jdGlvbiAodmFsLCBpbm5lck1vbmFkKSB7XG4gICAgcmV0dXJuIHZhbC5yZWR1Y2UoZnVuY3Rpb24gKGxpc3QsIGkpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xXG4gICAgICB2YXIgb3ZlciA9IGZhbHNlXG4gICAgICB3aGlsZSAoIW92ZXIpIHtcbiAgICAgICAgbGlzdC5wdXNoKGlubmVyTW9uYWQubWFwKGZ1bmN0aW9uIChpbm5lckxpc3QpIHtcbiAgICAgICAgICBpbmRleCsrXG4gICAgICAgICAgaWYgKGluZGV4IC0gMSA9PT0gaW5uZXJMaXN0Lmxlbmd0aCkge292ZXIgPSB0cnVlfVxuICAgICAgICAgIHJldHVybiBpbm5lckxpc3RbaW5kZXhdXG4gICAgICAgIH0sIGkpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGxpc3RcbiAgICB9LCBbXSlcbiAgfVxuXG59XG4iXX0=
